
<!DOCTYPE html>
<html>
<head>
    <title>Optical Fiber VR Lab</title>
    <!-- A-Frame Library CDN -->
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <style>
        /* Optional: Center the canvas in the page */
        body { margin: 0; overflow: hidden; }
    </style>
</head>
<body>

    <!--
        A-FRAME SCENE: The core container for the 3D world.
    -->
    <a-scene background="color: #ECECEC" vr-mode-ui="enabled: true">

        <!-- Camera and User Controls -->
        <a-entity camera look-controls wasd-controls position="0 1.6 3"></a-entity>

        <!-- Environment: Floor and Wall (The Lab Bench) -->
        <a-box id="lab-bench"
            position="0 0.0 -0.5"
            rotation="0 0 0"
            width="8" height="0.05" depth="4"
            color="#5C4033"
            shadow>
        </a-box>

        <!-- ========================================================================= -->
        <!-- 1. CORE SETUP: Light Source, Fiber, and Photodetector -->
        <!-- ========================================================================= -->

        <!-- Light Source (LED Module) -->
        <a-box id="light-source"
            position="-3.5 0.25 -0.5"
            width="0.5" height="0.4" depth="0.4"
            color="#A020F0"
            shadow>
            <a-text value="LED Source" align="center" width="1.5" position="0 0.25 0" color="#FFF"></a-text>
        </a-box>

        <!-- Photodetector (Power Meter) -->
        <a-box id="photodetector"
            position="3.5 0.25 -0.5"
            width="0.5" height="0.4" depth="0.4"
            color="#008080"
            shadow>
            <a-text value="Power Meter" align="center" width="1.5" position="0 0.25 0" color="#FFF"></a-text>
        </a-box>
        
        <!-- Long Optical Fiber (for Attenuation Measurement) -->
        <!-- Visualizing attenuation: The light color fades from bright to dimmer red -->
        <a-entity id="fiber-attenuation">
            <!-- Starting section (high intensity) -->
            <a-cylinder radius="0.02" height="7" color="#FF0000" material="emissive:#FF0000; emissiveIntensity:1.5"
                        position="0 0.25 -0.5" rotation="0 90 0">
            </a-cylinder>
            <!-- Mid section (medium intensity) -->
            <a-cylinder radius="0.02" height="3.5" color="#FF3333" material="emissive:#FF3333; emissiveIntensity:0.8"
                        position="-1.75 0.25 -0.5" rotation="0 90 0">
            </a-cylinder>
            <!-- End section (low intensity) -->
            <a-cylinder radius="0.02" height="3.5" color="#FF6666" material="emissive:#FF6666; emissiveIntensity:0.4"
                        position="1.75 0.25 -0.5" rotation="0 90 0">
            </a-cylinder>
        </a-entity>


        <!-- ========================================================================= -->
        <!-- 2. NUMERICAL APERTURE (NA) MEASUREMENT VISUALIZATION -->
        <!-- ========================================================================= -->

        <!-- NA Measurement Board/Jig -->
        <a-box id="na-jig"
            position="-3.5 0.45 1.5"
            width="3.5" height="0.05" depth="0.05"
            color="#333333"
            rotation="90 0 0"
            shadow>
        </a-box>

        <!-- Short Fiber End (The Emitter) -->
        <a-cylinder radius="0.02" height="0.2" color="#FFFFFF" material="emissive:#FFFFFF; emissiveIntensity:1"
            position="-3.5 0.6 1.5" rotation="90 0 0">
        </a-cylinder>
        
        <!-- Screen for NA Measurement -->
        <a-plane id="na-screen"
            position="-3.5 1 1.5"
            rotation="0 0 0"
            width="1.5" height="1.5"
            color="#FFFFFF"
            shadow>
            <a-text value="W = Spot Diameter\nL = Distance" align="center" width="1" position="0 0.6 0.01" color="#000"></a-text>
            <!-- NA Cone (Acceptance/Emission Cone) -->
            <a-cone id="acceptance-cone"
                height="0.5" radius-bottom="0.5" radius-top="0"
                position="0 -0.25 0.0"
                rotation="-90 0 0"
                material="color: red; opacity: 0.5; transparent: true; emissive: red; emissiveIntensity: 0.5">
            </a-cone>
            <!-- Projected Light Spot (The circle on the screen) -->
            <a-circle radius="0.5" color="#FF6347"
                position="0 0 0.01"
                material="emissive:#FF6347; emissiveIntensity: 1; opacity: 0.7; transparent: true">
            </a-circle>
        </a-plane>
        
        <a-text value="Numerical Aperture (NA) Measurement\nNA = sin(θ_max) ≈ (W/2) / L"
            align="left" width="2" position="-3.5 1.8 1.5" color="#333"></a-text>

        <!-- ========================================================================= -->
        <!-- 3. ATTENUATION CONSTANT (α) VISUALIZATION AND DISPLAY -->
        <!-- ========================================================================= -->

        <!-- Power Meter Display at Position 1 (L1 = 1m) -->
        <a-box position="-2.0 0.6 1.5" width="0.8" height="0.4" depth="0.05" color="#000" shadow>
             <a-text value="P_out1" align="center" width="1.5" position="0 0.15 0.03" color="#FFF"></a-text>
             <a-text value="10.0 dBm" align="center" width="1.5" position="0 -0.05 0.03" color="#00FF00"></a-text>
        </a-box>

        <!-- Power Meter Display at Position 2 (L2 = 5m) -->
        <a-box position="2.0 0.6 1.5" width="0.8" height="0.4" depth="0.05" color="#000" shadow>
            <a-text value="P_out2" align="center" width="1.5" position="0 0.15 0.03" color="#FFF"></a-text>
            <a-text value="7.0 dBm" align="center" width="1.5" position="0 -0.05 0.03" color="#FFFF00"></a-text>
        </a-box>
        
        <a-text value="Attenuation Constant (α) Measurement\nα (dB/km) = (P_1 - P_2) / (L_2 - L_1)"
            align="left" width="2" position="2.0 1.8 1.5" color="#333"></a-text>
            
        <!-- A-Frame Default Lights for General Illumination -->
        <a-entity light="type: ambient; color: #BBB; intensity: 0.5"></a-entity>
        <a-entity light="type: directional; color: #FFF; intensity: 0.8" position="-5 10 5"></a-entity>
    </a-scene>
</body>
</html
